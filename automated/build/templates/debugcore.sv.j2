// ===========================================================
// File generated by yaml2sv.py
// Run `python3 yaml2sv.py` to generate this instance file from debugcore.yaml
// Author: nikhil-wisig
// ===========================================================

localparam int DW_EVENT_LOG = {{dw_event_logs}};
localparam int DW_MSG_LOG = {{dw_msg_logs}};
localparam int NUM_EVENTS = {{num_events}};
localparam int NUM_MSGS = {{num_msgs}};
localparam int INMSG_WIDTH = {{input_max_msg_width}};
localparam int DW_TIMER = {{dw_timer}};

//! axis tdata
logic [$bits(debugcore_t) - 1:0] param_debugcore_tdata;
//! axis tvalid
logic param_debugcore_tvalid;
//! axis tready
logic param_debugcore_tready;

//! axis tdata
logic [DW_EVENT_LOG - 1:0] eventlogs_tdata;
//! axis tvalid
logic eventlogs_tvalid;
//! axis tready
logic eventlogs_tready;

//! axis tdata
logic [DW_MSG_LOG - 1:0] msglogs_tdata;
//! axis tvalid
logic msglogs_tvalid;
//! axis tready
logic msglogs_tready;

//! axis tdata
logic [64 - 1:0] debugdata_tdata;
//! axis tvalid
logic debugdata_tvalid;
//! axis tready
logic debugdata_tready;

logic [NUM_EVENTS - 1:0] events;
logic [INMSG_WIDTH*NUM_MSGS - 1:0] msg_i;
logic [NUM_MSGS - 1:0] msg_valid_i;

{% for event in events %}
//! {{loop.index - 1}}: {{event.description}}
logic {{event.name}};{% endfor %}

{% for msg in messages %}
//! {{loop.index - 1}}: {{msg.description}}
logic [INMSG_WIDTH - 1:0] {{msg.name}};
logic {{msg.name}}_valid;{% endfor %}

assign msg_i = {{ "{" }}{% for msg in messages|reverse %}{{ msg.name }}{% if not loop.last %}, {% endif %}{% endfor %}{{ "}" }};
assign msg_valid_i = {{ "{" }}{% for msg in messages|reverse %}{{ msg.name }}_valid{% if not loop.last %}, {% endif %}{% endfor %}{{ "}" }};

assign events = {{ "{" }}{% for event in events|reverse %}{{ event.name }}{% if not loop.last %},{% endif %}{% endfor %}{{ "}" }};
wn_debugcore 
#(
    .DW_TIMER({{dw_timer}}),
    .NUM_EVENTS({{num_events}}),
    .NUM_MSGS({{num_msgs}}),
    .INMSG_WIDTH({{input_max_msg_width}}),
    .DW_MSG(32 )
)
inst_debugcore (
    .clk (CLK245M ),
    .reset_n (RST_245M_N ),

    .param_tdata (param_debugcore_tdata ),
    .param_tvalid (param_debugcore_tvalid ),
    .param_tready (param_debugcore_tready ),

    .input_trigger (1'b1 ),

    .events (events ),

    .msg_i (msg_i ),
    .msg_valid_i (msg_valid_i ),

    .s_tdata (),
    .s_tvalid (),
    .s_tlast (),
    .s_tready (),

    .output_trigger (),    
    .sitrep (),

    .eventlogs_tdata (eventlogs_tdata ),
    .eventlogs_tvalid (eventlogs_tvalid ),
    .eventlogs_tready (eventlogs_tready ),

    .msglogs_tdata (msglogs_tdata ),
    .msglogs_tvalid (msglogs_tvalid ),
    .msglogs_tready (msglogs_tready ),

    .m_tdata (debugdata_tdata ),
    .m_tvalid (debugdata_tvalid ),
    .m_tuser (debugdata_tuser ),
    .m_tlast (debugdata_tlast ),
    .m_tready (debugdata_tready)
);

{# {% for event in events %}
assign {{event.name}} = ;{% endfor %} #}

